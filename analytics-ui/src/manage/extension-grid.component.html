<c8y-title>{{ "All extensions" | translate }}</c8y-title>

<c8y-breadcrumb>
  <c8y-breadcrumb-item
    [icon]="'c8y-atom'"
    [label]="'Ecosystem' | translate"
  ></c8y-breadcrumb-item>
  <c8y-breadcrumb-item
    [icon]="'c8y-streaming-analytics'"
    [label]="'Analytics' | translate"
  ></c8y-breadcrumb-item>
  <c8y-breadcrumb-item
    [icon]="'c8y-modules'"
    [label]="'Manage extensions' | translate"
    [path]="'sag-ps-pkg-analytics-extension/manage'"
  >
  </c8y-breadcrumb-item>
</c8y-breadcrumb>

<c8y-action-bar-item [placement]="'right'">
  <button
    (click)="addExtension()"
    class="btn btn-link"
    title="{{ 'Add extension' | translate }}"
  >
    <i c8yIcon="plus-circle"></i>
    {{ "Add extension" | translate }}
  </button>
</c8y-action-bar-item>

<c8y-action-bar-item [placement]="'right'">
  <button
    (click)="restartCEP()"
    class="btn btn-link"
    title="{{ 'Deploy extension (Restart)' | translate }}"
  >
    <i c8yIcon="c8y-solution-accelerator"></i>
    {{ "Deploy extension (Restart)" | translate }}
  </button>
</c8y-action-bar-item>

<c8y-action-bar-item [placement]="'right'">
  <button
    (click)="loadExtensions()"
    class="btn btn-link"
    title="{{ 'Refresh' | translate }}"
  >
    <i [ngClass]="{ 'icon-spin': loading }" c8yIcon="refresh"></i>
    {{ "Refresh" | translate }}
  </button>
</c8y-action-bar-item>

<c8y-action-bar-item [placement]="'left'" itemClass="navbar-form hidden-xs">
  <c8y-list-display-switch
    (onListClassChange)="listClass = $event"
    [listLength]="(extensions$ | async)?.length"
  ></c8y-list-display-switch>
</c8y-action-bar-item>

<div *ngIf="!loadingError && (extensions$ | async)?.length === 0" class="row">
  <div class="col-lg-4 col-lg-offset-5 text-center">
    <c8y-ui-empty-state
      [icon]="'plugin'"
      [title]="'No extensions loaded.' | translate"
      [subtitle]="'Add your first extension by clicking below.' | translate"
      [horizontal]="true"
    >
      <button
        (click)="addExtension()"
        class="btn btn-default btn-sm m-t-8"
        title="{{ 'Add extension' | translate }}"
      >
        {{ "Add extension" | translate }}
      </button></c8y-ui-empty-state
    >
  </div>
</div>

<p class="text-center">
  <c8y-progress-bar
    message="Streaming Analytics Engine is restarting ..."
    *ngIf="(restarting$ | async)"
  >
  </c8y-progress-bar>
</p>

<div
  [ngClass]="listClass"
  class="card-group"
  *ngIf="!loading && !(restarting$ | async)"
>
  <div
    class="page-sticky-header hidden-xs d-flex"
    *ngIf="(extensions$ | async)?.length > 0"
  >
    <div class="card-block card-column-20">
      <div class="card-appicon p-l-32 p-r-16 m-r-0 m-l-4"></div>
      {{ "Extension" | translate }}
    </div>
    <div class="card-block card-column-20">{{ "Loaded" | translate }}</div>
    <div class="card-block card-column-20">
      {{ "Number Blocks" | translate }}
    </div>
    <div class="card-block card-column-20">{{ "Created" | translate }}</div>
    <div class="card-block card-column-10"></div>
  </div>
  <div
    *ngFor="let extension of extensions$ | async"
    class="col-xs-12 col-sm-4 col-md-3"
  >
    <extension-card
      (onAppDeleted)="loadExtensions()"
      [extension]="extension"
      class="d-contents"
    ></extension-card>
  </div>
</div>

<div
  class="col-lg-8 col-lg-offset-2 m-b-48 text-center"
  style="padding-top: 48px"
  *ngIf="loadingError"
>
  <h2>
    <span class="label label-primary text-14">
      Please stand by until the streaming analytics engine is started
      successfully. Retry in a short while ...
    </span>
  </h2>
</div>

<div
  class="col-lg-8 col-lg-offset-2 m-b-48 text-center"
  style="padding-top: 48px"
  *ngIf="loading"
>
  <h2 class="p-b-24">
    <span class="label label-primary text-14">
      Please stand by until the information about the extension is loaded.
    </span>
  </h2>
  <c8y-loading></c8y-loading>
</div>
